

## Что такое `Enclosing` в Python?

**Enclosing scope** — это один из уровней областей видимости в Python,  
возникающий, когда функция определена *внутри другой функции*.

## Определение `enclosing scope`

**Enclosing scope** — это ближайшая внешняя **лексическая область видимости**,  
которая для данной внутренней функции окружает её определение и откуда она может захватывать имена.

1. Понятие **enclosing** всегда определяется относительно **внутренней** функции,  
а не как самостоятельная сущность **внешней** функции.

2. **Лексическая область видимости (`lexical scope`)** в определении означает, что данная  
область видимости определяется тем, **где в коде** написана функция или переменная,  
а не тем, где и когда она вызывается.

Иными словами, `enclosing scope` для внутренней функции `inner()`, будет  
ВСЯ область внешней функции `outer(*args, **kwargs)`, включая параметры `*args, **kwargs`.  
⚠️ НО, **за исключением** локальных переменных самой функции`inner()`.

---

## Иерархия областей видимости в Python

Как мы помним, иерархия областей видимости в Python обозначается аббревиатурой **LEGB**:

1. **L – Local** (локальная область функции)
2. **E – Enclosing** (область внешней функции, окружающая)
3. **G – Global** (глобальная область модуля)
4. **B – Built-in** (встроенные имена Python)

---

## Когда появляется Enclosing?

Когда одна функция определена внутри другой:

```python
def outer():
    x = 10
    
    def inner():
        print(x)  # x из enclosing scope функции outer
    
    inner()
```

Здесь:

* `x` — **enclosing variable**
* `outer` — *enclosing function*
* `inner` — *inner function*, которая имеет доступ к окружению `outer`

---

## Свойства Enclosing scope

### 1. Доступ «только для чтения»

По умолчанию переменные внешней функции нельзя изменять внутри внутренней:

```python
def outer():
    x = 10
    def inner():
        x = 20    # создаст новую локальную inner.x
    inner()
    print(x)      # 10
```

### 2. Чтобы изменить переменную enclosing, используют **nonlocal**

```python
def outer():
    x = 10
    def inner():
        nonlocal x
        x = 20
    inner()
    print(x)  # 20
```

### 3. Enclosing используется для создания замыкания (`closure`)

```python
def make_adder(a):
    def adder(b):
        return a + b  # a — из enclosing
    return adder

add5 = make_adder(5)
print(add5(3))  # 8
```

Переменная `a` «запоминается» внутри `adder`, даже после выхода из `make_adder`.

---

## Enclosing vs Global

| Особенность     | Enclosing          | Global           |
| --------------- | ------------------ | ---------------- |
| Где определена? | во внешней функции | на уровне модуля |
| Доступ          | автоматический     | автоматический   |
| Изменение?      | через `nonlocal`   | через `global`   |

---


## Итог

**Enclosing — это область видимости внешних (окружающих) функций.**
Она:

* возникает только при вложенных функциях
* предоставляет переменные для чтения
* допускает изменение переменных через `nonlocal`
* позволяет создавать замыкания

⚠️ 
Замыкание — один из немногих объектов в Python, который 
может одновременно хранить в себе и данные, и код.

Обычно объекты в Python могут хранить либо данные (dict, list, str, int и т.д.), 
либо код (functions).
