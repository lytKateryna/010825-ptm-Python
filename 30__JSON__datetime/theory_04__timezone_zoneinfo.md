## Работа с временными зонами в Python (`datetime`, `timezone`, `zoneinfo`)


### 1. Архитектура работы с временными зонами

В Python разделены **хранение информации о зоне** и **вычисления**:

| Компонент                    | За что отвечает                                                          |
| ---------------------------- | ------------------------------------------------------------------------ |
| **`datetime`**               | выполняет все вычисления (сложение, вычитание, перевод часовых поясов)   |
| **`timezone` (класс)**       | хранит *фиксированное* смещение от UTC (например, UTC+3)                 |
| **`tzinfo` (базовый класс)** | общий интерфейс описания зон                                             |
| **`zoneinfo`**               | хранит реальные часовые пояса мира (DST, законы, исторические изменения) |

---

### 2. `timezone` — фиксированные часовые пояса

Используется, если нужна простая зона вида *UTC+X*:

```python
from datetime import datetime, timezone, timedelta

utc_plus_3 = timezone(timedelta(hours=3))
dt = datetime(2025, 1, 1, 12, tzinfo=utc_plus_3)
```

### ✦ Ограничения:

* нет DST (летнего времени)
* нет исторических изменений
* нет политических переходов

Использовать только для простых случаев.

---

### 3. `zoneinfo` — реальные часовые пояса

Поддерживает:

* летнее/зимнее время (DST)
* изменения законов
* исторические переходы
* все временные зоны IANA (Europe/Moscow, America/New_York…)

Пример:

```python
from datetime import datetime
from zoneinfo import ZoneInfo

dt = datetime(2025, 3, 1, 12, tzinfo=ZoneInfo("Europe/Moscow"))
```

---

### 4. Перевод времени между часовыми поясами

Перевод осуществляется методом `astimezone()` в объекте `datetime`.

```python
from datetime import datetime
from zoneinfo import ZoneInfo

dt = datetime(2025, 1, 1, 12, tzinfo=ZoneInfo("Europe/Moscow"))
converted = dt.astimezone(ZoneInfo("America/New_York"))
```

---

### 5. Арифметика дат в разных зонах

Все вычисления делает **сам `datetime`**, зоны используются только для корректировки времени.

### Пример вычитания:

```python
dt1 = datetime(2025, 1, 1, 12, tzinfo=ZoneInfo("Europe/Moscow"))
dt2 = datetime(2025, 1, 1, 3, tzinfo=ZoneInfo("UTC"))

delta = dt1 - dt2
```

### Результат:

```
9:00:00  (9 часов разницы)
```

`datetime` сам учитывает: Москва = UTC+3.

---

### 6. Сравнение `timezone` и `zoneinfo`

| Возможность                | `timezone`      | `zoneinfo`                        |
| -------------------------- | --------------- | --------------------------------- |
| Фиксированное смещение UTC | ✔️              | ✔️                                |
| Летнее время (DST)         | ❌               | ✔️                                |
| Реальные часовые пояса     | ❌               | ✔️                                |
| Исторические переходы      | ❌               | ✔️                                |
| Рекомендация Python        | Для простых зон | **Для всех реальных мировых зон** |

---

### Резюме

* Все вычисления — **внутри `datetime`**.
* Класс `timezone` — упрощённый механизм фиксированных смещений.
* `zoneinfo` — современный стандарт для настоящих временных зон.
* Метод `astimezone()` осуществляет перевод между зонами.
* Операции `datetime ± timedelta`, `datetime - datetime` работают корректно с зонами.
